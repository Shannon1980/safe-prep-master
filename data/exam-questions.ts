export interface ExamQuestion {
  id: string;
  question: string;
  options: string[];
  correctIndex: number;
  correctIndices?: number[];
  multiSelect?: number;
  domain: ExamDomain;
}

export type ExamDomain =
  | 'Introducing Scrum in SAFe'
  | 'Defining the SM/TC Role'
  | 'Supporting Team Events'
  | 'Supporting ART Events';

export const EXAM_CONFIG = {
  totalQuestions: 45,
  timeLimitMinutes: 90,
  passingPercentage: 73,
  passingScore: 33,
};

export const EXAM_QUESTIONS: ExamQuestion[] = [
  // ── Domain 1: Introducing Scrum in SAFe (22–28%) ──
  { id: 'd1-1', question: 'Which value of the Agile Manifesto prioritizes direct human communication?', options: ['Individuals and interactions over processes and tools', 'Working software over comprehensive documentation', 'Customer collaboration over contract negotiation', 'Responding to change over following a plan'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-2', question: 'What is the primary measure of progress in Agile development?', options: ['Working software', 'Completed documentation', 'Hours worked', 'Number of meetings held'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-3', question: 'Which Agile Manifesto principle addresses sustainable development?', options: ['Sponsors, developers, and users should maintain a constant pace indefinitely', 'Deliver working software frequently', 'Welcome changing requirements', 'Build projects around motivated individuals'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-4', question: 'What are the three pillars of Scrum?', options: ['Transparency, Inspection, and Adaptation', 'Planning, Execution, and Delivery', 'Vision, Backlog, and Increment', 'Commitment, Focus, and Respect'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-5', question: 'What is the SAFe recommended iteration length?', options: ['Two weeks', 'One week', 'Three weeks', 'Four weeks'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-6', question: 'Which Scrum event is called "Team Sync" in SAFe terminology?', options: ['Daily Scrum', 'Sprint Planning', 'Sprint Review', 'Sprint Retrospective'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-7', question: 'An Agile Team in SAFe typically has how many members?', options: ['10 or fewer', 'Exactly 7', '15 to 20', 'No limit'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-8', question: 'What distinguishes an Agile Release Train (ART) from a single Agile Team?', options: ['An ART is a long-lived team of 5–12 Agile Teams synchronized on a common cadence', 'An ART is a temporary project team assembled for one release', 'An ART replaces the need for Scrum Masters', 'An ART focuses exclusively on technical infrastructure'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-9', question: 'Which of the following is a built-in quality practice in SAFe?', options: ['Pairing and peer review', 'Manual regression testing at the end', 'Code review by management only', 'Quality inspection by a separate QA department'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-10', question: 'What does "develop on cadence, release on demand" mean?', options: ['Teams follow a regular development rhythm but release value when the business needs it', 'Teams release code every day regardless of quality', 'Teams only work when customers request features', 'Development and releases happen on the same fixed schedule'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-11', question: 'What does the CALMR approach to DevOps stand for?', options: ['Culture, Automation, Lean flow, Measurement, Recovery', 'Collaboration, Agility, Lean, Management, Resilience', 'Continuous, Automated, Lightweight, Managed, Reliable', 'Code, Architecture, Logging, Monitoring, Reporting'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-12', question: 'What is the purpose of the Continuous Delivery Pipeline in SAFe?', options: ['To enable continuous exploration, integration, deployment, and release on demand', 'To automate management reporting', 'To replace PI Planning', 'To eliminate the need for testing'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-13', question: 'Which characteristic is essential for a high-performing Agile Team?', options: ['Cross-functional skills and self-organization', 'A single technical specialty across all members', 'Strict hierarchy with detailed task assignments', 'Individual accountability over team collaboration'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-14', question: 'What is the goal of each iteration in SAFe?', options: ['To deliver new value in the form of working functionality', 'To complete all items in the product backlog', 'To write comprehensive design documents', 'To perform a complete regression test'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'd1-15', question: 'According to the Agile Manifesto, what should teams prefer over following a plan?', options: ['Responding to change', 'Completing documentation', 'Meeting deadlines', 'Tracking metrics'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },

  // ── Domain 2: Defining the SM/TC Role (26–30%) ──
  { id: 'd2-1', question: 'What type of leadership best describes the Scrum Master role?', options: ['Servant leadership', 'Directive leadership', 'Autocratic leadership', 'Laissez-faire leadership'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-2', question: 'A Scrum Master should move away from "knowing the answer" and toward which behavior?', options: ['Letting the team find their own way', 'Providing detailed technical solutions', 'Making decisions faster than the team', 'Documenting all decisions for the team'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-3', question: 'What are the five key responsibilities of a Scrum Master in SAFe?', options: ['Facilitating PI Planning, Supporting Iteration Execution, Improving Flow, Building High-Performing Teams, Improving ART Performance', 'Writing code, Testing software, Deploying releases, Managing budgets, Hiring team members', 'Sprint Planning, Sprint Review, Sprint Retrospective, Daily Scrum, Backlog Grooming', 'Estimating stories, Assigning tasks, Tracking hours, Reporting status, Managing risks'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-4', question: "According to Lencioni, what is the foundational dysfunction that leads to all other team dysfunctions?", options: ['Absence of Trust', 'Fear of Conflict', 'Lack of Commitment', 'Inattention to Results'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-5', question: "What are the four stages of team development according to Tuckman's model?", options: ['Forming, Storming, Norming, Performing', 'Planning, Building, Testing, Releasing', 'Starting, Growing, Maturing, Declining', 'Initiating, Executing, Monitoring, Closing'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-6', question: 'How should a Scrum Master handle a conflict between two team members?', options: ['Meet with them, identify what each wants and why, and find common ground', 'Make the decision for them to save time', 'Escalate immediately to the RTE', 'Ignore it and hope it resolves naturally'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-7', question: 'What is the purpose of working agreements?', options: ['To facilitate conflict management and establish team norms', 'To define the technical architecture', 'To assign individual performance targets', 'To document the project schedule'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-8', question: 'A servant leader Scrum Master should persuade rather than:', options: ['Use authority', 'Listen to others', 'Ask questions', 'Facilitate discussions'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-9', question: 'The Scrum Master works with which ART-level role to ensure the train meets its PI objectives?', options: ['Release Train Engineer (RTE)', 'Product Manager', 'System Architect', 'Business Owner'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-10', question: "What should a Scrum Master focus on instead of driving toward specific outcomes?", options: ["Being invested in the team's overall performance", 'Ensuring every feature is completed on time', 'Tracking individual developer productivity', 'Reporting all issues to management'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-11', question: 'Which trait of a servant leader involves setting long-term operating goals for the team?', options: ['Thinks beyond day-to-day activities', 'Listens and supports team members', 'Persuades rather than uses authority', 'Is open and appreciates openness in others'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-12', question: 'How does SAFe help address the "Fear of Conflict" dysfunction?', options: ['Scrum creates a safe environment for conflict; the SM encourages discussion of disagreements', 'Conflict is eliminated by having the RTE make all decisions', 'Team members are not allowed to disagree during events', 'All conflicts are documented and reported to management'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-13', question: 'What is the best approach when a team cannot reach consensus?', options: ['Make a majority decision and clarify that everyone will support it', 'Let the loudest voice win', 'Postpone the decision indefinitely', 'Have the Scrum Master decide'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-14', question: 'A Scrum Master should coach the team to collaborate rather than:', options: ['Coordinating individual contributions', 'Facilitating group discussions', 'Encouraging team problem-solving', 'Focusing on business value delivery'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'd2-15', question: 'Which practice helps the Scrum Master encourage team learning?', options: ['Fostering collaborative practices like pair programming and collective code ownership', 'Assigning individual learning targets with deadlines', 'Restricting access to external resources', 'Having the tech lead teach all team members'], correctIndex: 0, domain: 'Defining the SM/TC Role' },

  // ── Domain 3: Supporting Team Events (17–21%) ──
  { id: 'd3-1', question: 'What is the timebox for Iteration Planning?', options: ['Four hours or less', 'Eight hours', 'Two hours maximum', 'One hour'], correctIndex: 0, domain: 'Supporting Team Events' },
  { id: 'd3-2', question: 'What is the purpose of capacity allocation during Iteration Planning?', options: ['To balance new user stories with maintenance, refactors, and technical debt', 'To assign specific tasks to specific developers', 'To limit the number of team members in the iteration', 'To calculate individual performance bonuses'], correctIndex: 0, domain: 'Supporting Team Events' },
  { id: 'd3-3', question: 'During the Team Sync, each team member answers three questions. Which is NOT one of them?', options: ['How many hours did I work yesterday?', 'What did I do yesterday to advance the iteration goals?', 'What will I do today to advance the iteration goals?', 'Are there any impediments preventing the team from meeting iteration goals?'], correctIndex: 0, domain: 'Supporting Team Events' },
  { id: 'd3-4', question: 'What is a common anti-pattern during the Iteration Review?', options: ['The demo is mainly slides and talk instead of working software', 'Different team members take turns demoing', 'Stakeholders provide feedback', 'The PO invites key stakeholders'], correctIndex: 0, domain: 'Supporting Team Events' },
  { id: 'd3-5', question: 'Who should attend the Iteration Retrospective?', options: ['Agile Team members only — no external stakeholders', 'All ART stakeholders and executives', 'Only the Scrum Master and Product Owner', 'Business Owners and management'], correctIndex: 0, domain: 'Supporting Team Events' },
  { id: 'd3-6', question: 'What is the timebox for a Backlog Refinement session?', options: ['1–2 hours per iteration', '4 hours per iteration', '15 minutes daily', 'One full day per PI'], correctIndex: 0, domain: 'Supporting Team Events' },
  { id: 'd3-7', question: 'What anti-pattern occurs when the team sees stories for the first time during Iteration Planning?', options: ['Not doing Backlog Refinement consistently', 'Over-refining the backlog', 'Having too many stakeholders attend', 'Using the wrong estimation technique'], correctIndex: 0, domain: 'Supporting Team Events' },
  { id: 'd3-8', question: "The Iteration Retrospective has two parts. What are they?", options: ["Quantitative (metrics review) and Qualitative (what went well, what didn't, improvements)", 'Technical (code review) and Business (feature review)', 'Individual (self-assessment) and Team (group assessment)', 'Planning (next iteration) and Review (current iteration)'], correctIndex: 0, domain: 'Supporting Team Events' },
  { id: 'd3-9', question: 'What is the primary purpose of the Iteration Review?', options: ['To demonstrate working software and collect stakeholder feedback', "To retrospect on the team's process", 'To plan the next iteration', 'To estimate stories for the backlog'], correctIndex: 0, domain: 'Supporting Team Events' },
  { id: 'd3-10', question: 'What should the Scrum Master do when poor Team Syncs are a symptom of deeper problems?', options: ['Identify root causes like poor collaboration, lack of collective ownership, or unresolved conflict', 'Cancel the Team Sync and replace it with email updates', 'Extend the timebox to 30 minutes', 'Have the manager attend to enforce discipline'], correctIndex: 0, domain: 'Supporting Team Events' },
  { id: 'd3-11', question: 'A team commits to iteration goals. How should they handle unfeasibility?', options: ['Immediately raise the concern so corrective action can be taken', 'Work overtime to meet the commitment', 'Silently drop the lowest-priority item', 'Wait until the next PI Planning to report the issue'], correctIndex: 0, domain: 'Supporting Team Events' },
  { id: 'd3-12', question: 'Which is a Scrum Master anti-pattern during Iteration Planning?', options: ['Creating an unrealistic commitment', 'Maintaining the timebox', 'Ensuring improvement items from the retrospective are put into action', 'Challenging the team to exceed previous accomplishments'], correctIndex: 0, domain: 'Supporting Team Events' },

  // ── Domain 4: Supporting ART Events (25–29%) ──
  { id: 'd4-1', question: 'PI Planning is a cadence-based event that occurs how often and for how long?', options: ['Every 8–12 weeks, over 2 days', 'Every 4 weeks, for 1 day', 'Every 6 months, for 3 days', 'Monthly, for half a day'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-2', question: 'What are PI Objectives?', options: ['Business summaries of what each team intends to deliver in the upcoming PI', 'Individual performance goals for team members', 'Technical specifications for each feature', 'Budget allocations for the quarter'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-3', question: 'What is the purpose of uncommitted objectives?', options: ['To improve delivery predictability by providing a capacity guard band', 'To track work that the team refuses to do', 'To document features rejected by Business Owners', 'To list personal development goals'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-4', question: 'Who assigns business value (1–10) to team PI objectives?', options: ['Business Owners', 'Product Owners', 'Scrum Masters', 'The RTE'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-5', question: 'What does ROAM stand for when managing PI risks?', options: ['Resolved, Owned, Accepted, Mitigated', 'Reviewed, Organized, Assigned, Managed', 'Reported, Observed, Analyzed, Monitored', 'Ranked, Outlined, Addressed, Minimized'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-6', question: 'What does a confidence vote at the end of PI Planning represent?', options: ["Each team's confidence in meeting their PI objectives, with commitment to escalate if not achievable", 'A vote on whether to cancel the PI', 'Individual performance self-assessments', "Management's approval of the budget"], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-7', question: 'What are the three parts of the Inspect & Adapt event?', options: ['PI System Demo, Quantitative/Qualitative Measurement, and Problem-Solving Workshop', 'Code Review, Architecture Review, and Budget Review', 'Sprint Review, Sprint Retrospective, and Sprint Planning', 'Status Update, Risk Assessment, and Team Assessment'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-8', question: 'What is the Innovation and Planning (IP) iteration used for?', options: ['Innovation, hackathons, PI Planning preparation, and a capacity guard band for delivery', 'Only for fixing bugs from the previous PI', 'Taking vacation and reducing workload', 'Writing detailed design specifications'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-9', question: 'What happens during the management review at the end of PI Planning Day 1?', options: ['Management adjusts scope and objectives based on challenges, risks, and impediments identified', 'Management assigns bonus targets to each team', 'All teams are required to add more scope', 'Individual performance reviews are conducted'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-10', question: 'Which tool is used in the I&A problem-solving workshop to identify the biggest root cause?', options: ['Pareto analysis', 'SWOT analysis', 'Gantt chart', 'Risk matrix'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-11', question: 'What does INVEST stand for in the context of user stories?', options: ['Independent, Negotiable, Valuable, Estimable, Small, Testable', 'Iterative, Necessary, Verified, Essential, Scoped, Tracked', 'Incremental, Notable, Viable, Efficient, Simple, Timely', 'Integrated, Normalized, Valid, Executable, Secure, Tested'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-12', question: 'How is ART predictability measured?', options: ['By comparing planned business value against actual business value achieved for PI objectives', 'By counting total lines of code written', 'By measuring individual developer velocity', 'By tracking the number of meetings held per PI'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-13', question: 'What is a common Scrum Master anti-pattern during PI Planning?', options: ['Pressure is put on the team to overcommit', 'Maintaining timeboxes for team breakouts', 'Facilitating coordination with other teams', 'Ensuring an honest confidence vote'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-14', question: 'What are the four types of enabler stories?', options: ['Infrastructure, Architecture, Exploration, and Compliance', 'Technical, Functional, Performance, and Security', 'Frontend, Backend, Database, and Integration', 'Unit, Integration, System, and Acceptance'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'd4-15', question: "What consequences arise when the IP iteration is skipped?", options: ["Technical debt grows, people burn out, and there's no time to plan or innovate", 'Teams deliver more features faster', 'Velocity naturally increases', 'Stakeholders receive more frequent demos'], correctIndex: 0, domain: 'Supporting ART Events' },

  // ── Study Guide Questions (from SAFe SM LNF Study Questions) ──

  // Domain 2: Defining the SM/TC Role
  { id: 'lnf-1', question: 'Why is it important for the Scrum Master to help the team focus on daily and Iteration goals?', options: ['To keep the Team Backlog to a manageable size', 'To eliminate impediments', 'To help the team maintain their velocity', 'To facilitate the team\'s progress towards the current PI Objectives'], correctIndex: 3, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-2', question: 'The Scrum Master is what above all else?', options: ['A servant leader', 'A team coach', 'An event facilitator', 'The iteration owner'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-3', question: 'The SAFe Scrum Master role includes responsibilities to which other group?', options: ['Business owners', 'Solution Management', 'Solution Train Engineers', 'The other Agile Teams on the Agile Release Train (ART)'], correctIndex: 3, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-4', question: 'Which team dysfunction does SAFe help address with the help of Business Owners?', options: ['Missed timeboxes', 'Lack of visibility', 'Lack of transparency', 'Avoidance of accountability'], correctIndex: 3, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-5', question: 'What is an example of Scrum Master servant leader behavior?', options: ['Strives to create a conflict-free environment', 'Uses persuasion instead of authority', 'Focuses on the day-to-day team activities', 'Keeps their opinions to themselves'], correctIndex: 1, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-6', question: 'Why is it important for a Scrum Master to be a servant leader?', options: ['To drive the team to succeed', 'To coach the team in effective engineering practices', 'To help the team become high-performing', 'To provide team structure'], correctIndex: 2, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-7', question: 'What is a characteristic of an effective Scrum Master?', options: ['Gives open, honest opinions', 'Understands customer needs', 'Is a technical expert', 'Removes all conflict'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-8', question: 'An effective Scrum Master helps the team with what?', options: ['Team metrics', 'Relentless improvement', 'Deploying work', 'Risk mitigation'], correctIndex: 1, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-9', question: 'How does the Scrum Master provide the most value to the team?', options: ['By ensuring timeboxes are kept during team meetings', 'By scheduling critical scrum events', 'By facilitating discussions between the Product Owner and the team', 'By removing impediments for the team'], correctIndex: 3, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-10', question: 'Scrum Masters help remove impediments, foster an environment for high-performing team dynamics, and what else?', options: ['Form and re-form teams', 'Continuously deliver value', 'Estimate stories', 'Lead team efforts in relentless improvement'], correctIndex: 3, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-11', question: 'What foundational issue most often leads to team dysfunction?', options: ['Weak Lean-Agile leadership', 'Lack of commitment', 'Absence of trust', 'Fear of conflict'], correctIndex: 2, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-12', question: 'A servant leader knows that his or her own growth comes from what?', options: ['Effective training', 'Management support', 'Facilitating the growth of others', 'Implementing a CALMR approach to DevOps'], correctIndex: 2, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-13', question: 'How does SAFe handle the \'fear of conflict\' team dysfunction?', options: ['Avoids discussion of disagreements', 'Uses scrum to create a safe environment for conflict', 'Has teams engage in retrospectives', 'Reviews results at the end of every iteration'], correctIndex: 1, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-14', question: 'Scrum Masters are effective by using scrum methods, supporting SAFe principles and practices, and what else?', options: ['Supporting delivery using Agile practices', 'Serving as a customer proxy', 'Writing stories and enablers', 'Managing architectural runway'], correctIndex: 0, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-15', question: 'What falls outside the Scrum Master\'s responsibility? (Choose two.)', options: ['Estimating Stories for the team', 'Facilitating backlog refinement', 'Assigning Stories to team members', 'Facilitating the team\'s Innovation and Planning event'], correctIndex: 0, correctIndices: [0, 2], multiSelect: 2, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-16', question: 'Which two behaviors should a Scrum Master represent as a coach? (Choose two.)', options: ['Set long-term goals for the team', 'Provide subject matter expertise', 'Encourage the team to learn from their mistakes', 'Lay out the team\'s plan for the iteration', 'Focus on deadlines and technical options'], correctIndex: 2, correctIndices: [2, 3], multiSelect: 2, domain: 'Defining the SM/TC Role' },
  { id: 'lnf-17', question: 'Becoming a coach requires a shift from old behaviors to new ones. What are three examples of new coaching behaviors? (Choose three.)', options: ['Drive toward specific outcomes', 'Fix problems for the team', 'Focus on business value delivery', 'Focus on deadlines', 'Ask the team for the answer', 'Facilitate team problem-solving'], correctIndex: 2, correctIndices: [2, 4, 5], multiSelect: 3, domain: 'Defining the SM/TC Role' },

  // Domain 1: Introducing Scrum in SAFe
  { id: 'lnf-18', question: 'The goal of Lean is to deliver the maximum Customer value in the shortest sustainable lead time while providing what else?', options: ['The highest possible quality', 'A Continuous Delivery Pipeline', 'Improved capacity allocation', 'Significant team contributions'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'lnf-19', question: 'What is one purpose of iterations?', options: ['To provide an architectural basis for future development', 'To provide a regular cadence for producing increments of value', 'To provide fast feedback learning cycles and frequent integration', 'To demonstrate the increment to stakeholders'], correctIndex: 1, domain: 'Introducing Scrum in SAFe' },
  { id: 'lnf-20', question: 'What does the letter C represent in SAFe\'s CALMR approach to DevOps?', options: ['Collaboration', 'Continuous delivery', 'Culture', 'Continuous deployment'], correctIndex: 2, domain: 'Introducing Scrum in SAFe' },
  { id: 'lnf-21', question: 'SAFe is based on three primary bodies of knowledge which include Agile development, systems thinking, and what type of product development?', options: ['Iterative product development', 'Adaptive product development', 'Incremental product development', 'Lean product development'], correctIndex: 3, domain: 'Introducing Scrum in SAFe' },
  { id: 'lnf-22', question: 'What does transparency mean in a scrum environment?', options: ['Team members must immediately share any and all feedback with each other', 'Development and Operations teams work together', 'The team is constantly improving its process', 'The process is visible to all stakeholders'], correctIndex: 3, domain: 'Introducing Scrum in SAFe' },
  { id: 'lnf-23', question: 'When is a Feature hypothesis fully evaluated?', options: ['When the Feature\'s return on investment has been realized', 'When the Customer uses the Feature in production', 'When the Feature is accepted by Product Management', 'When the Feature has been deployed to production'], correctIndex: 1, domain: 'Introducing Scrum in SAFe' },
  { id: 'lnf-24', question: 'When working with an Agile Team, what is expected from Product Management?', options: ['To clarify the scope of feature work', 'To define the technical software specifications', 'To provide the iteration goals to the team', 'To prioritize the team backlog'], correctIndex: 0, domain: 'Introducing Scrum in SAFe' },
  { id: 'lnf-25', question: 'Cadence and synchronization help reduce uncertainty and manage what?', options: ['Product Management', 'Other commitments', 'Capacity allocation', 'The variability in Solution development'], correctIndex: 3, domain: 'Introducing Scrum in SAFe' },

  // Domain 3: Supporting Team Events
  { id: 'lnf-26', question: 'How often should a system demo occur?', options: ['After the end of each program increment (PI)', 'After every release', 'After every iteration', 'After every other iteration'], correctIndex: 2, domain: 'Supporting Team Events' },
  { id: 'lnf-27', question: 'At the end of the first Iteration, the team finishes User Stories A, B, and 50% of C. The Story sizes are: Story A = 8 points, Story B = 1 point, Story C = 5 points, Story D = 3 points. What is the team\'s velocity?', options: ['9', '7', '14', '11.5'], correctIndex: 0, domain: 'Supporting Team Events' },
  { id: 'lnf-28', question: 'When is iteration planning completed?', options: ['When iteration goals are defined', 'When story analysis is complete', 'When the team commits to the plan', 'When the team capacity is determined'], correctIndex: 2, domain: 'Supporting Team Events' },
  { id: 'lnf-29', question: 'What is a common reason why a team is unable to estimate a story?', options: ['The story does not include a role', 'The story lacks acceptance criteria', 'The team has no experience in estimating', 'The team does not understand the tasks related to the story'], correctIndex: 1, domain: 'Supporting Team Events' },
  { id: 'lnf-30', question: 'When estimating stories, what is the Scrum Master\'s key responsibility?', options: ['Limit discussion to manage timeboxes', 'Provide information about customer needs', 'Ensure everyone on the team participates', 'Ensure the team gives accurate estimates'], correctIndex: 2, domain: 'Supporting Team Events' },

  // Domain 4: Supporting ART Events
  { id: 'lnf-31', question: 'How can a Scrum Master support a problem-solving workshop?', options: ['By providing facilitation to breakout groups focused on specific problems', 'By acting as a subject matter expert and suggesting improvements', 'By coaching the Release Train Engineer on managing the event', 'By estimating the work effort required to implement recommended improvements'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'lnf-32', question: 'What is the goal of the scrum of scrums event?', options: ['To review the Agile Release Train\'s progress toward its PI Objectives', 'To focus on Agile Release Train process improvement', 'To review each team\'s progress on its Stories', 'To demo Features to Product Management'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'lnf-33', question: 'Which Agile Manifesto principle describes the importance of PI Planning in SAFe?', options: ['Working software is the primary measure of progress', 'Simplicity, the art of maximizing the amount of work not done, is essential', 'The best architectures, requirements, and designs emerge from self-organizing teams', 'The most efficient and effective method of conveying information to and within an Agile Team is face-to-face conversation'], correctIndex: 3, domain: 'Supporting ART Events' },
  { id: 'lnf-34', question: 'What is an innovation and planning (IP) Iteration anti-pattern?', options: ['Leave the IP iteration empty of work as an estimating guard band', 'Plan work for the IP iteration during program increment (PI) planning', 'Plan innovation spikes or hackathons to occur during the IP iteration', 'Use the IP iteration for infrastructure improvements'], correctIndex: 1, domain: 'Supporting ART Events' },
  { id: 'lnf-35', question: 'What is one benefit of program increment (PI) objectives?', options: ['They describe a process for defining team goals', 'They ensure accurate status reporting', 'They create a near-term focus and vision', 'They form a guiding coalition'], correctIndex: 2, domain: 'Supporting ART Events' },
  { id: 'lnf-36', question: 'What is one of the Scrum Master\'s responsibilities during the innovation and planning (IP) Iteration?', options: ['Update the program increment (PI) roadmap', 'Facilitate the team preparation for the program increment (PI) system demo', 'Remove scope that exceeds capacity', 'Create the program predictability measure'], correctIndex: 1, domain: 'Supporting ART Events' },
  { id: 'lnf-37', question: 'What is the Scrum Master\'s role in team breakout #1?', options: ['Facilitate the coordination with other teams for dependencies', 'Create mitigation plans for each risk', 'Raise team level risks', 'Resolve dependencies with other teams'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'lnf-38', question: 'When looking at a program board at the end of program increment (PI) planning, what does it mean when a feature is placed in a team\'s swim lane with no strings?', options: ['That the team has not broken the feature into stories yet and has not identified dependencies', 'That the team has been assigned, but the feature dependencies have not been identified yet', 'That it has dependencies on teams in other Agile release trains (ARTs) or Solution Trains', 'That the feature can be completed by that team independently'], correctIndex: 3, domain: 'Supporting ART Events' },
  { id: 'lnf-39', question: 'Why is a confidence vote held at the end of program increment (PI) planning?', options: ['To build shared commitment to the plan', 'To remove the risks for the PI', 'To ensure the business owners accept the plan', 'To hold the teams accountable if the Agile release train does not deliver on its commitment'], correctIndex: 0, domain: 'Supporting ART Events' },
  { id: 'lnf-40', question: 'During PI Planning, who owns Feature priorities?', options: ['Release Train Engineer', 'Business Owner', 'Solution Architect/Engineer', 'Product Management'], correctIndex: 3, domain: 'Supporting ART Events' },
  { id: 'lnf-41', question: 'What are two common anti-patterns during program increment (PI) planning? (Choose two.)', options: ['Pressure is put on teams to overcommit', 'A detailed plan becomes the goal rather than alignment', 'Alignment becomes the goal rather than a detailed plan', 'The innovation and planning (IP) iteration is left empty of planned work', 'The team determines their own capacity and load'], correctIndex: 0, correctIndices: [0, 1], multiSelect: 2, domain: 'Supporting ART Events' },
  { id: 'lnf-42', question: 'Which two practices are recommended in SAFe for root cause analysis? (Choose two.)', options: ['Post-PI Planning meeting', 'Fishbone diagram', 'Iteration retrospective', 'Weighted shortest job first', '5 Whys'], correctIndex: 1, correctIndices: [1, 4], multiSelect: 2, domain: 'Supporting ART Events' },
  { id: 'lnf-43', question: 'What are two primary opportunities in SAFe for driving relentless improvement? (Choose two.)', options: ['Daily stand-up', 'Iteration retrospective', 'Inspect and adapt event', 'Iteration review', 'Management review and problem-solving meeting'], correctIndex: 1, correctIndices: [1, 2], multiSelect: 2, domain: 'Supporting ART Events' },
  { id: 'lnf-44', question: 'Which two actions are part of the Scrum Master\'s role in PI Planning? (Choose two.)', options: ['Prioritize Features to support the Program Vision', 'Ensure the team builds a plan they can commit to', 'Manage the program board', 'Serve as the Customer proxy and work with Product Management', 'Align the Agile Release Train to a common Vision'], correctIndex: 1, correctIndices: [1, 2], multiSelect: 2, domain: 'Supporting ART Events' },
];

export function selectExamQuestions(count: number = 45): ExamQuestion[] {
  const byDomain = new Map<ExamDomain, ExamQuestion[]>();
  for (const q of EXAM_QUESTIONS) {
    const list = byDomain.get(q.domain) || [];
    list.push(q);
    byDomain.set(q.domain, list);
  }

  const selected: ExamQuestion[] = [];
  const targets: [ExamDomain, number][] = [
    ['Introducing Scrum in SAFe', 11],
    ['Defining the SM/TC Role', 13],
    ['Supporting Team Events', 9],
    ['Supporting ART Events', 12],
  ];

  for (const [domain, target] of targets) {
    const questions = byDomain.get(domain) || [];
    const shuffled = [...questions].sort(() => Math.random() - 0.5);
    selected.push(...shuffled.slice(0, Math.min(target, shuffled.length)));
  }

  // Shuffle correct answer positions
  const randomized = selected.map((q) => {
    const correctSet = new Set(q.correctIndices ?? [q.correctIndex]);
    const pairs = q.options.map((opt, i) => ({ opt, isCorrect: correctSet.has(i) }));
    const shuffled = pairs.sort(() => Math.random() - 0.5);
    const newCorrectIndices = shuffled
      .map((p, i) => (p.isCorrect ? i : -1))
      .filter((i) => i !== -1);
    return {
      ...q,
      options: shuffled.map((p) => p.opt),
      correctIndex: newCorrectIndices[0],
      correctIndices: q.multiSelect ? newCorrectIndices : undefined,
    };
  });

  return randomized.sort(() => Math.random() - 0.5).slice(0, count);
}
